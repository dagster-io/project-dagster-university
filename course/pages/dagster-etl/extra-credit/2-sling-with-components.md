---
title: "Lesson 7: Sling with Components"
module: 'dagster_etl'
lesson: 'extra-credit'
---

# Sling with Components

To navigate including Components with Dagster, we will be using the Dagster `dg` command line. `dg` is a useful to initializing and navigating Dagster projects. Because we have been working the virtual envionment and project structure of this course we have not needed `dg` as much.

We used `dg` before to lanuch the UI to view and execute our assets but now we will use it to scaffold our Component.

To start run:

```bash
dg list plugins
```

This will list all the plugins available in our Dagster project. At the bottom of that output you should see plugins for for `dagster_dlt.DltLoadCollectionComponent` and `dagster_sling.SlingReplicationCollectionComponent`.

```
│ dagster_dlt   │ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓                                                                   │
│               │ ┃ Symbol                                 ┃ Summary                                            ┃ Features                     ┃                                                                   │
│               │ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩                                                                   │
│               │ │ dagster_dlt.DltLoadCollectionComponent │ Expose one or more dlt loads to Dagster as assets. │ [component, scaffold-target] │                                                                   │
│               │ └────────────────────────────────────────┴────────────────────────────────────────────────────┴──────────────────────────────┘                                                                   │
│ dagster_sling │ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓                                               │
│               │ ┃ Symbol                                            ┃ Summary                                                     ┃ Features                     ┃                                               │
│               │ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩                                               │
│               │ │ dagster_sling.SlingReplicationCollectionComponent │ Expose one or more Sling replications to Dagster as assets. │ [component, scaffold-target] │                                               │
│               │ └───────────────────────────────────────────────────┴─────────────────────────────────────────────────────────────┴──────────────────────────────┘                                               │
```

Both of these Component are available to use because our Python environment has the `dagster-dlt` and `dagster-sling` packages installed. As well as giving us the ability to work directly with the libraries, they also include the Component versions.

If we were starting our project from scratch we could add the plugin by adding it to our Python envrionment.

```bash
uv pip install dagster-sling
```

## Create dlt Component

To initialize our dlt Component, we will run the `dg` command to scaffold the Sling Component (`dagster_sling.SlingReplicationCollectionComponent`): 

```bash
dg scaffold 'dagster_sling.SlingReplicationCollectionComponent' ingest_files
```

There will now be a new directory in `defs` containing two files:

```
.
├── component.yaml
└── replication.yaml
```

These are the only two files we will need to interact with in order to configure our Sling assets (no Python). Let's discuss what goes into each.

## Configure the YAML

The `replication.yaml` should look familiar. That is the yaml file that Sling uses to determine the replication characteristics. The `replication.yaml` that is generated by the `dg` command is pretty much empty:

```yaml
source: {}
streams: {}
target: {}
```

Let's copy and paste all of the contents from our `sling_replication.yaml` from the previous lesson:

```yaml
source: MY_POSTGRES
target: MY_DUCKDB

defaults:
  mode: full-refresh

  object: "{stream_schema}_{stream_table}"

streams:
  data.customers:
  data.products:
  data.orders:
    mode: incremental
    primary_key: order_id
    update_key: order_date
```

The next file is the `component.yaml`. This contains two bits of information. Which component we are using, in this case Sling, and the location of the `replication.yaml`.

```
type: dagster_sling.SlingReplicationCollectionComponent

attributes:
  replications:
    - path: replication.yaml
```

The only thing we need to add are the connection details. Before we had defined these within the `SlingResource` but there is no need for that with Components. Instead we will enter the connection details in the `component.yaml`:

```yaml
type: dagster_sling.SlingReplicationCollectionComponent

attributes:
  sling:
    connections:
      - name: MY_POSTGRES
        type: postgres
        host: localhost
        port: 5432
        database: test_db
        user: test_user
        password: test_pass
      - name: MY_DUCKDB
        type: duckdb
        instance: duckdb:///var/tmp/duckdb.db
  replications:
    - path: replication.yaml
```

Notice that the names of the connection in the `components.yaml` still need to match up to the `replication.yaml` (`MY_DUCKDB` and `MY_POSTGRES`).

![Sling components comparison](/images/dagster-etl/extra-credit/components-vs-asset.png.png)

## Viewing the assets

Because we switching our assets over to components, we can cleanup a lot of our Python code. In `resources.py` you can remove everything related Sling. And in the `assets.py` file you can remove the assets generated by the `sling_assets`. We can still keep the assets downstream of the Component assets.

Now if we run `dg dev` we can see the same asset graph as before.

# TODO Include screenshot
